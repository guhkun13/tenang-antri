{{template "layouts/_header.html" .}}
<div
  class="min-h-screen bg-gradient-to-t from-purple-500 via-blue-500 to-blue-700"
>
  <!-- Header -->
  <header class="bg-white/10 backdrop-blur-md border-b border-white/20">
    <div class="max-w-4xl mx-auto px-4 py-4">
      <div class="flex justify-between items-center">
        <div class="flex items-center">
          <i class="fas fa-search-location text-2xl text-white mr-3"></i>
          <h1 class="text-xl font-bold text-white">Lacak Tiket</h1>
        </div>
        <div class="flex items-center gap-2">
          <a
            href="/login"
            class="px-3 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm transition-all flex items-center gap-2"
          >
            <i class="fas fa-user"></i>
            <span class="hidden sm:inline">Login</span>
          </a>
          <a
            href="/kiosk"
            class="px-3 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm transition-all flex items-center gap-2"
          >
            <i class="fas fa-ticket"></i>
            <span class="hidden sm:inline">Kiosk</span>
          </a>
          <a
            href="/display"
            class="px-3 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm transition-all flex items-center gap-2"
          >
            <i class="fas fa-tv"></i>
            <span class="hidden sm:inline">Monitor</span>
          </a>
        </div>
        <div class="text-right text-white">
          <p class="text-2xl font-bold" id="clock">--:--:--</p>
          <p class="text-purple-200 text-xs" id="date">Memuat...</p>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-4xl mx-auto px-4 py-6">
    <!-- Search Card -->
    <div class="bg-white rounded-xl shadow-2xl p-4 mb-6">
      <form id="tracking-form" class="flex flex-col gap-3">
        <input
          type="text"
          id="ticket-input"
          name="ticket_number"
          placeholder="No. Tiket"
          class="w-full px-4 py-3 text-lg font-bold text-center border-2 border-purple-200 rounded-xl focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none uppercase"
          autocomplete="off"
          required
        />
        <button
          type="submit"
          class="w-full px-4 py-3 bg-purple-600 text-white font-semibold rounded-xl hover:bg-purple-700 transition-colors shadow-lg"
        >
          <i class="fas fa-search mr-2"></i>Cari
        </button>
      </form>
    </div>

    <!-- Tracking Info Container -->
    <div id="tracking-info" hx-trigger="every 10s" hx-swap="innerHTML">
      <!-- Tracking info will be loaded here -->
    </div>
  </main>
</div>

<script>
  function updateClock() {
    const now = new Date();
    document.getElementById("clock").textContent = now.toLocaleTimeString(
      "id-ID",
      {
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
      },
    );
    document.getElementById("date").textContent = now.toLocaleDateString(
      "id-ID",
      {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric",
      },
    );
  }
  updateClock();
  setInterval(updateClock, 1000);

  document
    .getElementById("tracking-form")
    .addEventListener("submit", function (e) {
      e.preventDefault();
      const ticketNumber = document
        .getElementById("ticket-input")
        .value.trim()
        .toUpperCase();

      if (!ticketNumber) {
        return;
      }

      const container = document.getElementById("tracking-info");
      container.setAttribute("hx-get", `/track/info/${ticketNumber}`);
      container.setAttribute("hx-trigger", "load, every 10s");

      htmx.process(container);
      htmx.trigger(container, "load");
    });
</script>
{{template "layouts/_footer.html" .}}
